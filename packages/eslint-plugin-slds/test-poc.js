#!/usr/bin/env node

/**
 * Quick POC Test Script
 * Validates that the enhanced context analysis components are working
 */

const path = require('path');

console.log('üß™ Testing POC Context Analysis Components\n');

// Test 1: Component Context Collector
console.log('1Ô∏è‚É£ Testing ComponentContextCollector...');
try {
  const { ComponentContextCollector } = require('./build/utils/component-context-collector');
  console.log('   ‚úÖ ComponentContextCollector imported successfully');
  
  // Mock ESLint context for testing
  const mockContext = {
    getCwd: () => process.cwd(),
    filename: 'test.css'
  };
  
  const collector = new ComponentContextCollector(mockContext);
  console.log('   ‚úÖ ComponentContextCollector instantiated successfully');
} catch (error) {
  console.log('   ‚ùå ComponentContextCollector failed:', error.message);
}

// Test 2: Context-Aware Suggestion Scorer
console.log('\n2Ô∏è‚É£ Testing ContextAwareSuggestionScorer...');
try {
  const { ContextAwareSuggestionScorer } = require('./build/utils/context-aware-suggestion-scorer');
  console.log('   ‚úÖ ContextAwareSuggestionScorer imported successfully');
  
  const scorer = new ContextAwareSuggestionScorer();
  console.log('   ‚úÖ ContextAwareSuggestionScorer instantiated successfully');
  
  // Test scoring functionality
  const mockContext = {
    componentType: 'LWC',
    semanticContext: { hasModal: true, hasButton: false },
    cssContext: { existingHooks: [], selectors: [] }
  };
  
  const suggestions = scorer.scoreHooks(
    '#ffffff',
    ['--slds-c-modal-color-background', '--slds-g-color-neutral-base-100'],
    mockContext,
    'background-color',
    {}
  );
  
  console.log('   ‚úÖ Scoring functionality works, returned', suggestions.length, 'suggestions');
} catch (error) {
  console.log('   ‚ùå ContextAwareSuggestionScorer failed:', error.message);
}

// Test 3: Contextual Message Generator
console.log('\n3Ô∏è‚É£ Testing ContextualMessageGenerator...');
try {
  const { ContextualMessageGenerator } = require('./build/utils/contextual-message-generator');
  console.log('   ‚úÖ ContextualMessageGenerator imported successfully');
  
  const generator = new ContextualMessageGenerator();
  console.log('   ‚úÖ ContextualMessageGenerator instantiated successfully');
} catch (error) {
  console.log('   ‚ùå ContextualMessageGenerator failed:', error.message);
}

// Test 4: Enhanced Rule
console.log('\n4Ô∏è‚É£ Testing Enhanced Rule...');
try {
  const enhancedRule = require('./build/rules/v9/no-hardcoded-values/no-hardcoded-values-slds2-enhanced');
  console.log('   ‚úÖ Enhanced rule imported successfully');
  console.log('   ‚úÖ Rule has meta:', !!enhancedRule.meta);
  console.log('   ‚úÖ Rule has create function:', typeof enhancedRule.create === 'function');
} catch (error) {
  console.log('   ‚ùå Enhanced rule failed:', error.message);
}

// Test 5: Plugin Integration
console.log('\n5Ô∏è‚É£ Testing Plugin Integration...');
try {
  const plugin = require('./build/index');
  console.log('   ‚úÖ Plugin imported successfully');
  console.log('   ‚úÖ Enhanced rule available in plugin:', !!plugin.rules['no-hardcoded-values-slds2-enhanced']);
} catch (error) {
  console.log('   ‚ùå Plugin integration failed:', error.message);
}

console.log('\nüéâ POC Validation Complete!');
console.log('\nüìã Next Steps:');
console.log('   ‚Ä¢ Run: npm run build (if build system is set up)');
console.log('   ‚Ä¢ Run: node test/poc-comparison/comparison-test.js');
console.log('   ‚Ä¢ Test with actual ESLint configuration');
console.log('   ‚Ä¢ Review POC-CONTEXT-ANALYSIS.md for detailed documentation');

console.log('\nüí° POC Summary:');
console.log('   ‚Ä¢ Context-aware analysis system implemented');
console.log('   ‚Ä¢ Enhanced rule with component bundle analysis');
console.log('   ‚Ä¢ Intelligent suggestion scoring based on semantic context');
console.log('   ‚Ä¢ Rich violation reporting with contextual explanations');
console.log('   ‚Ä¢ Graceful fallback to standard behavior on errors');
console.log('   ‚Ä¢ Ready for integration testing and further development');
